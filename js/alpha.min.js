/*!
 * SkiCycleRun v4.0.0-alpha (https://skicyclerun.com)
 * Copyright 2018 - SkiCycleRun2019 Feo ElGato
 * Licensed under MIT repository git+https://github.com/timothyhalley/skicyclerun.git
 */
function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}async function selectMap(t){var e=t.substring(t.lastIndexOf("/")+1,t.length-2),a=t.substr(0,t.lastIndexOf("/")),o=a.substring(a.lastIndexOf("/")+1).trim();const s=await getPhotoTags(o,e),i={lat:parseFloat(s.GPSLatitude),lng:parseFloat(s.GPSLongitude)};var n=new google.maps.Map(document.getElementById("map"),{zoom:16,center:i,mapTypeId:google.maps.MapTypeId.TERRAIN});new google.maps.Marker({position:i,title:"SkiCycleRun"}).setMap(n)}async function getPhotoTags(t,e){try{let a="https://api.skicyclerun.com/deadpool/getPhotoTags/pub/"+t+"/"+e,o=await fetch(a,{cache:"no-cache"});return await o.json()}catch(t){console.log("ERROR: ",t)}}$(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",percentPosition:!0}),$(".grid-item").click(function(t){if($(this).hasClass("item-opened")){$(".grid").css("overflow","hidden"),$("html, body").animate({scrollTop:$("#map").offset().top},1200);const t="https://img.skicyclerun.com/pub/skiCycleRun/"+getRandomInt(1e4,10300)+".jpg";$(this).css("background-image",'url("'+t+'")')}else{$(this).outerWidth();var e=this.getBoundingClientRect();$(this).attr("data-coord-left",$(this).css("left")),$(this).attr("data-coord-top",$(this).css("top")),$(this).css({top:e.top,left:e.left}).delay(400).css({top:"120px",left:"10%",zIndex:"99999"}).addClass("item-opened"),$(".grid-alpha").fadeIn(),$(".map-alpha").delay(600).css({top:"0px",left:"0%",height:"100vw",zIndex:"99998"}).addClass("item-opened"),$("#map").css({top:"100vw",height:"100%"}),$("#map").fadeIn(),$(".map-alpha").css({"background-image":"linear-gradient(rgba(0, 0, 255, 0.5), rgba(255, 255, 0, 0.5)"}),$(".map-alpha").fadeIn(),$("html, body").animate({scrollTop:$(".grid").offset().top},650),$(".grid").css("overflow","visible"),selectMap($(this).css("background-image"))}}),$(document).on("click",function(t){$(".item-opened").length>0&&($(t.target).closest(".grid-item").length||$(t.target).hasClass("item-opened")||($(".grid-alpha").fadeOut(650),$(".map-alpha").fadeOut(650),$(".item-opened").css({top:$(".item-opened").data("coord-top"),left:$(".item-opened").data("coord-left"),marginLeft:""}),$("html, body").animate({scrollTop:$(".grid").offset().top+parseFloat($(".item-opened").data("coord-top"))-30},650),setTimeout(function(){$(".grid-item").css("z-index","").removeClass("item-opened")},350),$(".grid").css("overflow","hidden")))});